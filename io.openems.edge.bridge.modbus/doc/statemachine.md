# State-Machine

```mermaid
graph TD
ON_BEFORE_PROCESS_IMAGE>ON_BEFORE_PROCESS_IMAGE]
ON_EXECUTE_WRITE>ON_EXECUTE_WRITE]

ON_EXECUTE_WRITE ==> WRITE
INITIAL_WAIT -->|sleep| READ_BEFORE_WRITE
INITIAL_WAIT -.-o ON_EXECUTE_WRITE
READ_BEFORE_WRITE -->|read finished too early| WAIT_FOR_WRITE
READ_BEFORE_WRITE -.-o ON_EXECUTE_WRITE
WAIT_FOR_WRITE -.-o ON_EXECUTE_WRITE

WRITE -->|WriteTasks finished| WAIT_BEFORE_READ
WAIT_BEFORE_READ -->|finished sleeping| READ_AFTER_WRITE
READ_AFTER_WRITE -->|ReadTasks finished| FINISHED

ON_BEFORE_PROCESS_IMAGE ==> INITIAL_WAIT
FINISHED -.-o ON_BEFORE_PROCESS_IMAGE
```

View using Mermaid, e.g. https://mermaid-js.github.io/mermaid-live-editor