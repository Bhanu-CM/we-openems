<ion-header>
  <ion-toolbar class="ion-justify-content-center" color="primary">
    <ion-title>Wärmepumpe</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="modalCtrl.dismiss()">
        <ion-icon name="close-outline"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ng-container *ngIf="!loading">
    <ion-card-content class="underline">
      <table class="full_width">
        <tr>
          <td translate>
            General.mode
          </td>
        </tr>
      </table>
      <!-- Controller Mode -->
      <ion-segment (ionChange)="updateControllerMode($event)" [value]="component.properties['mode']" scrollable="false">
        <ion-segment-button value="MANUAL">
          <ion-label translate>
            General.manually
          </ion-label>
          <ion-icon color="success" style="width:40px" name="power-outline"></ion-icon>
        </ion-segment-button>
        <ion-segment-button value="AUTOMATIC">
          <ion-label translate>
            General.automatic
          </ion-label>
          <ion-icon style="width:40px" name="sunny-outline">
          </ion-icon>
        </ion-segment-button>
      </ion-segment>
    </ion-card-content>
    <!-- Manual Mode -->
    <!-- TODO: Translate -->

    <form [formGroup]="formGroup">
      <ng-container *ngIf="component.properties['mode'] == 'MANUAL'">
        <ion-card-content *ngIf="formGroup.value.workMode != 'NONE'" class="underline">
          <ion-list>
            <ion-item class="ion-no-padding" style="cursor: pointer;" (click)="updateManualMode('FORCE_ON')"
              lines="none">
              <ion-label class="regularFont">Einschaltbefehl</ion-label>
              <ion-toggle [checked]="formGroup.value.manualState == 'FORCE_ON'"></ion-toggle>
            </ion-item>
            <ion-item class="ion-no-padding" style="cursor: pointer;" (click)="updateManualMode('RECOMMENDATION')"
              lines="none">
              <ion-label class="regularFont">Einschaltempfehlung</ion-label>
              <ion-toggle [checked]="formGroup.value.manualState == 'RECOMMENDATION'"></ion-toggle>
            </ion-item>
            <ion-item class="ion-no-padding" style="cursor: pointer;" (click)="updateManualMode('REGULAR')"
              lines="none">
              <ion-label class="regularFont">Normalbetrieb</ion-label>
              <ion-toggle [checked]="formGroup.value.manualState == 'REGULAR'"></ion-toggle>
            </ion-item>
            <ion-item class="ion-no-padding" style="cursor: pointer;" (click)="updateManualMode('LOCK')" lines="none">
              <ion-label class="regularFont">Sperre</ion-label>
              <ion-toggle [checked]="formGroup.value.manualState == 'LOCK'"></ion-toggle>
            </ion-item>
          </ion-list>
        </ion-card-content>
      </ng-container>
    </form>
    <!-- Automatic Mode -->
    <ng-container *ngIf="component.properties['mode'] == 'AUTOMATIC'">
      <ion-card-content class="underline">
        <ion-item class="ion-no-padding" style="cursor: pointer;" lines="none">
          <ion-label class="regularFont">Einschaltempfehlung</ion-label>
          <ion-toggle></ion-toggle>
        </ion-item>

        <table class="full_width">
          <tr>
            <td style="width: 65%">
              Ab Überschusseinspeisung von
            </td>
            <td style="width: 35%" class="align_right">
              <ion-item class="ion-no-padding" lines="inset">
                <ion-input class="regularFont" inputmode="decimal" style="text-align: end;">
                </ion-input>
                <ion-label class="regularFont">&nbsp;W</ion-label>
              </ion-item>
            </td>
          </tr>
        </table>
      </ion-card-content>

      <ion-card-content class="underline">
        <ion-item class="ion-no-padding" style="cursor: pointer;" lines="none">
          <ion-label class="regularFont">Einschaltbefehl
          </ion-label>
          <ion-toggle></ion-toggle>
        </ion-item>

        <ng-container>
          <table class="full_width">
            <tr>
              <td style="width: 65%">
                Ab Überschusseinspeisung von
              </td>
              <td style="width: 35%" class="align_right">
                <ion-item class="ion-no-padding" lines="inset">
                  <ion-input class="regularFont" inputmode="decimal" style="text-align: end;">
                  </ion-input>
                  <ion-label class="regularFont">&nbsp;W</ion-label>
                </ion-item>
              </td>
            </tr>
            <tr>
              <td style="width: 65%;">
                und über Ladezustand von</td>
              <td style="width: 35%" class="align_right ion-padding-end">
                {{ 88 | unitvalue:'%' }}
              </td>
            </tr>
          </table>
          <table class="full_width">
            <tr>
              <ion-range pin color="dark" min="1" max="100">
                <ion-label slot="start">
                  {{ 0 | unitvalue:'%' }}
                </ion-label>
                <ion-label slot="end">
                  {{ 100 | unitvalue:'%' }}
                </ion-label>
              </ion-range>
            </tr>
          </table>
        </ng-container>
      </ion-card-content>

      <ion-card-content class="underline">
        <ion-item class="ion-no-padding" style="cursor: pointer;" lines="none">
          <ion-label class="regularFont">Sperre</ion-label>
          <ion-toggle></ion-toggle>
        </ion-item>
        <ng-container>
          <table class="full_width">
            <tr>
              <td style="width: 5%">
                <ion-checkbox checked="true"></ion-checkbox>
              </td>
              <td style="width: 60%">
                Ab Netzbezug von
              </td>
              <td style="width: 35%" class="align_right">
                <ion-item class="ion-no-padding" lines="inset">
                  <ion-input class="regularFont" inputmode="decimal" style="text-align: end;">
                  </ion-input>
                  <ion-label class="regularFont">&nbsp;W</ion-label>
                </ion-item>
              </td>
            </tr>
          </table>
          <table class="full_width">
            <tr>
              <td style="width: 5%">
                <ion-checkbox checked="true"></ion-checkbox>
              </td>
              <td style="width: 60%;">
                Unter Ladezustand von</td>
              <td style="width: 35%" class="align_right ion-padding-end">
                {{ 666 | unitvalue:'%' }}
              </td>
            </tr>
          </table>
          <table class="full_width">
            <tr>
              <ion-range pin color="dark" min="1" max="100">
                <ion-label slot="start">
                  {{ 0 | unitvalue:'%' }}
                </ion-label>
                <ion-label slot="end">
                  {{ 100 | unitvalue:'%' }}
                </ion-label>
              </ion-range>
            </tr>
          </table>
        </ng-container>
      </ion-card-content>
      <ion-card-content class="underline">
        <table class="full_width">
          <tr>
            <td style="width: 65%" translate>
              Edge.Index.Widgets.Singlethreshold.minSwitchingTime
            </td>
            <td style="width: 35%" class="align_right">
              <ion-item lines="inset" class="ion-no-padding">
                <ion-input class="regularFont" inputmode="decimal" style="text-align: end;">
                </ion-input>
                <ion-label class="regularFont">&nbsp;s</ion-label>
              </ion-item>
            </td>
          </tr>
        </table>
      </ion-card-content>
    </ng-container>

    <ion-fab *ngIf="formGroup.dirty" class="ion-padding-bottom" vertical="bottom" horizontal="center" slot="fixed">
      <ion-fab-button (click)="applyChanges()">
        <ion-icon size="large" name="checkmark-circle-outline">
        </ion-icon>
      </ion-fab-button>
    </ion-fab>
    <ion-grid *ngIf="loading == true">
      <ion-progress-bar type="indeterminate"></ion-progress-bar>
    </ion-grid>
  </ng-container>
</ion-content>